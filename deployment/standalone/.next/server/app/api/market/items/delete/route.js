"use strict";(()=>{var e={};e.id=2264,e.ids=[2264],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},7656:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>x,originalPathname:()=>q,patchFetch:()=>S,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>b,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>y});var o={};r.r(o),r.d(o,{POST:()=>m,dynamic:()=>u,fetchCache:()=>p,revalidate:()=>d});var s=r(95419),a=r(69108),i=r(99678),n=r(78070),l=r(42509);let c="market_items",u="force-dynamic",d=0,p="force-no-store";async function m(e){try{console.log("POST /api/market/items/delete - Starting deletion process");let{id:t}=await e.json();if(!t)return console.error("No item ID provided in request body"),n.Z.json({success:!1,error:"Item ID is required"},{status:400});console.log(`Attempting to delete item with ID: ${t}`);try{console.log("Connecting to Supabase...");let e=await (0,l.e)(),{data:r,error:o}=await e.from(c).select("id").eq("id",t).maybeSingle();if(o)throw console.error("Error checking if item exists:",o),Error(`Database query error: ${o.message}`);if(!r)return console.log(`Item with ID ${t} not found in database`),n.Z.json({success:!0,message:"Item not found, nothing to delete",id:t});let{error:s}=await e.from(c).delete().eq("id",t);if(s)throw console.error("Error deleting item:",s),Error(`Failed to delete item: ${s.message}`);return console.log(`Successfully deleted item with ID: ${t}`),n.Z.json({success:!0,message:"Item deleted successfully",id:t})}catch(e){return console.error("Database operation failed:",e),n.Z.json({success:!1,error:"Failed to delete item from database",details:e instanceof Error?e.message:String(e)},{status:500})}}catch(e){return console.error("Unexpected error processing delete request:",e),n.Z.json({success:!1,error:"Failed to process deletion request",details:e instanceof Error?e.message:String(e)},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/market/items/delete/route",pathname:"/api/market/items/delete",filename:"route",bundlePath:"app/api/market/items/delete/route"},resolvedPagePath:"E:\\copycoder-2025-04-13T00-58-05-829Z\\src\\app\\api\\market\\items\\delete\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:b,headerHooks:x,staticGenerationBailout:y}=g,q="/api/market/items/delete/route";function S(){return(0,i.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:f})}},42509:(e,t,r)=>{let o;r.d(t,{e:()=>n});var s=r(24459),a=r(7439);try{o=global.fetch}catch(e){console.warn("Native fetch not available, using polyfill would be needed")}let i=e=>new Promise(t=>setTimeout(t,e)),n=async(e=3)=>{try{console.log("Creating server-side Supabase client...");let t=(0,a.cookies)(),r="https://your-project-id.supabase.co".trim(),n="your-supabase-anon-key".trim();if(!r||!n)throw console.error("Missing Supabase environment variables:",r?"":"NEXT_PUBLIC_SUPABASE_URL",n?"":"NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error("Missing required Supabase configuration");let l=null;for(let a=1;a<=e;a++)try{console.log(`Attempt ${a} of ${e} to create Supabase client`);let i=(0,s.lx)(r,n,{cookies:{get:e=>t.get(e)?.value},auth:{persistSession:!1,autoRefreshToken:!1},global:{fetch:o,headers:{"X-Client-Info":"next-server-supabase"}},db:{schema:"public"},realtime:{timeout:1e4}});try{let e=await i.from("health_check").select("*").limit(1).maybeSingle();if(e.error)throw console.warn(`Health check failed on attempt ${a}:`,e.error),e.error;console.log("Supabase server client created and verified successfully")}catch(e){if(e.message&&e.message.includes('relation "health_check" does not exist'))console.log("Health check table does not exist, but connection seems good");else throw e}return i}catch(t){if(l=t,console.error(`Failed to initialize Supabase client (attempt ${a}/${e}):`,t),a<e){let e=Math.min(500*Math.pow(2,a-1),5e3);console.log(`Retrying in ${e}ms...`),await i(e)}}throw Error(`Supabase client initialization failed after ${e} attempts: ${l instanceof Error?l.message:String(l)}`)}catch(e){throw console.error("Error creating Supabase server client:",e),e}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[1638,6206,7439,4459],()=>r(7656));module.exports=o})();