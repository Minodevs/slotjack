(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7820],{8711:function(e,t,a){Promise.resolve().then(a.bind(a,7287))},9108:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},7759:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]])},8994:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},94:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},834:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},699:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},8670:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9295:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]])},489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7287:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var r=a(3827),s=a(4090),l=a(5947),o=a(7907),n=a(8792),i=a(5561),c=a(9108),d=a(8994),m=a(834),u=a(8670),g=a(94),h=a(8998),p=a(7461);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,p.Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var x=a(2600);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,p.Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);var b=a(9295),k=a(489),v=a(7759),w=a(2235),j=a(699),N=a(5494),S=a(8009),U=a(1097),C=a(9644);let I="slotjack_market_items",E="market_items";function T(){let e=(0,o.useRouter)(),t=(0,l.useAuth)(),[a,p]=(0,s.useState)(!0),[T,A]=(0,s.useState)([]),[Z,P]=(0,s.useState)(""),[D,z]=(0,s.useState)(!1),[M,L]=(0,s.useState)(null),[R,O]=(0,s.useState)(null),[Y,F]=(0,s.useState)(null),[_,q]=(0,s.useState)(!1),[J,V]=(0,s.useState)(null),[B,H]=(0,s.useState)(!1),[$,G]=(0,s.useState)(!1),[K,X]=(0,s.useState)(null),[Q,W]=(0,s.useState)({}),[ee,et]=(0,s.useState)({name:"",price:0,points:0,category:"betting",description:"",imageUrl:"",stock:-1,featured:!1,virtual:!1,priceType:"TRY"}),[ea,er]=(0,s.useState)({name:"",points:3500,imageUrl:"/market-img/zlat.png"}),[es,el]=(0,s.useState)([]);if(!t)throw Error("AuthContext is undefined");let{user:eo}=t;(0,s.useEffect)(()=>{if(!a&&(!eo||eo.rank!==i.X.ADMIN)){e.push("/");return}eo&&(en(),p(!1))},[eo,a,e]);let en=async()=>{try{p(!0),V(null);let t=new AbortController,a=setTimeout(()=>t.abort(),5e3);try{console.log("Trying to load market items from API...");let r=await fetch("/api/market/items",{cache:"no-store",headers:{"Cache-Control":"no-cache"},signal:t.signal});if(clearTimeout(a),r.ok){var e;let t=await r.json();if(console.log("Loaded items from API:",(null===(e=t.items)||void 0===e?void 0:e.length)||0),t.items&&t.items.length>0){let e=Date.now(),a=t.items.map(t=>t.imageUrl&&!t.imageUrl.includes("?")?{...t,imageUrl:"".concat(t.imageUrl,"?t=").concat(e)}:t);A(a),localStorage.setItem(I,JSON.stringify(a)),p(!1);return}throw console.log("API returned empty items array"),Error("API returned empty items array")}throw console.error("Error from API (".concat(r.status,")")),Error("API error: ".concat(r.status))}catch(e){clearTimeout(a),console.error("Error fetching from API:",e),"AbortError"===e.name&&console.error("API request timed out")}for(let e=1;e<=2;e++)try{console.log("Trying direct Supabase access (attempt ".concat(e,"/2)..."));let t=await em(),{data:a,error:r}=await t.from(E).select("*").order("id");if(r){if(console.error("Error loading items from Supabase (attempt ".concat(e,"):"),r),e<2){await new Promise(e=>setTimeout(e,1e3));continue}throw r}if(a&&a.length>0){console.log("Loaded items from Supabase:",a.length);let e=Date.now(),t=a.map(t=>t.imageUrl&&!t.imageUrl.includes("?")?{...t,imageUrl:"".concat(t.imageUrl,"?t=").concat(e)}:t);A(t),localStorage.setItem(I,JSON.stringify(t)),p(!1);return}throw console.log("No items found in Supabase"),Error("No items found in Supabase")}catch(t){if(e<2){await new Promise(e=>setTimeout(e,1e3));continue}console.error("All Supabase attempts failed:",t)}try{console.log("Trying localStorage...");let e=localStorage.getItem(I);if(e){let t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){console.log("Loaded ".concat(t.length," items from localStorage")),A(t),p(!1),S.toast.error("\xc7evrimdışı mod: Sunucu bağlantısı kurulamadı, yerel veriler kullanılıyor",{icon:"\uD83D\uDCF1",duration:5e3});return}}throw Error("No items found in localStorage")}catch(e){console.error("Error reading from localStorage:",e)}console.log("All data sources failed. Using empty items array"),A([]),S.toast.error("Veriler y\xfcklenemedi! \xdcr\xfcn ekleyerek başlayabilirsiniz.",{duration:5e3})}catch(e){console.error("Error in loadMarketItems:",e),V("Market \xfcr\xfcnleri y\xfcklenemedi: "+(e instanceof Error?e.message:String(e)))}finally{p(!1)}},ei=async e=>{let t=0;for(;t<=2;)try{t>0&&(console.log("Retry attempt ".concat(t,"/").concat(2," for Supabase save...")),await new Promise(e=>setTimeout(e,1e3*t))),console.log("Connecting to Supabase...");let a=await (0,U.e)();try{let{error:e}=await a.from("health_check").select("*").limit(1).maybeSingle();if(e&&!e.message.includes("does not exist"))throw e}catch(e){if(e.message&&e.message.includes("does not exist"))console.log("Supabase connection test OK (table not found)");else throw e}console.log("Deleting existing items...");let{error:r}=await a.from(E).delete().not("id","eq","");if(r)return console.error("Error deleting existing items:",r),{success:!1,message:r.message};console.log("Inserting ".concat(e.length," items..."));let{data:s,error:l}=await a.from(E).insert(e).select();if(l)return console.error("Error inserting items:",l),{success:!1,message:l.message};return console.log("Successfully saved items to Supabase:",(null==s?void 0:s.length)||0),{success:!0,message:"Saved ".concat((null==s?void 0:s.length)||0," items to database")}}catch(a){let e=a instanceof Error?a.message:String(a);if(console.error("Supabase save attempt ".concat(t+1," failed:"),e),t>=2)return console.error("All Supabase save attempts failed"),{success:!0,message:"Saved to local storage only (offline mode)"};t++}return{success:!1,message:"Unknown error saving items"}},ec=()=>{try{localStorage.setItem("market_items_updated",Date.now().toString()),window.dispatchEvent(new CustomEvent("market-items-updated",{detail:{source:"admin-panel",timestamp:Date.now()}})),console.log("Broadcast market item changes to all tabs/windows")}catch(e){console.error("Error broadcasting changes:",e)}},ed=async e=>{if(confirm("Bu \xfcr\xfcn\xfc silmek istediğinizden emin misiniz?"))try{X(e);try{let t=await fetch("/api/market/items?id=".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate"},cache:"no-store"}),a=await t.json();if(a.success)console.log("Item deleted via API successfully");else throw Error(a.error||"API delete failed")}catch(r){console.error("API delete failed, trying direct Supabase delete",r);let t=await em(),{error:a}=await t.from(E).delete().eq("id",e);if(a)throw console.error("Supabase delete failed too:",a),a}let t=T.filter(t=>t.id!==e);A(t),localStorage.setItem(I,JSON.stringify(t)),S.toast.success("\xdcr\xfcn başarıyla silindi"),ec()}catch(e){console.error("Error deleting item:",e),S.toast.error("\xdcr\xfcn silinirken bir hata oluştu")}finally{X(null)}},em=async()=>{let e=null;for(let t=1;t<=2;t++)try{console.log("Creating Supabase client (attempt ".concat(t,"/").concat(2,")..."));let e=await (0,U.e)();try{let{error:t}=await e.from("health_check").select("*").limit(1).maybeSingle();if(t&&!t.message.includes('relation "health_check" does not exist')&&!t.message.includes("does not exist"))throw t;return console.log("Supabase client created successfully"),e}catch(t){if(t.message&&(t.message.includes('relation "health_check" does not exist')||t.message.includes("does not exist")))return console.log("Supabase connection good (health check table not found)"),e;throw t}}catch(a){if(e=a,console.error("Failed to create Supabase client (attempt ".concat(t,"/").concat(2,"):"),a),t<2){let e=Math.min(1e3*Math.pow(2,t-1),4e3);console.log("Retrying in ".concat(e,"ms...")),await new Promise(t=>setTimeout(t,e))}}throw console.error("Failed to create Supabase client after ".concat(2," attempts")),e||Error("Failed to create Supabase client")},eu=T.filter(e=>""===Z||e.name.toLowerCase().includes(Z.toLowerCase())||e.category.toLowerCase().includes(Z.toLowerCase())||e.description.toLowerCase().includes(Z.toLowerCase())),eg=()=>{L(null),et({name:"",price:0,points:0,category:"betting",description:"",imageUrl:"",stock:-1,featured:!1,virtual:!1,priceType:"TRY"}),O(null),F(null),z(!0),V(null)},eh=e=>{V(null),L(e.id);let t=0,a="TRY";"string"==typeof e.price?e.price.includes("$")?(t=Number(e.price.replace("$","")),a="USD"):e.price.includes("₺")?(t=Number(e.price.replace("₺","")),a="TRY"):t=Number(e.price):"number"==typeof e.price?t=e.price:"number"==typeof e.priceValue&&(t=e.priceValue);let r=e.imageUrl||"";r.includes("?")&&(r=r.split("?")[0]),et({id:e.id,name:e.name||"",price:t,points:Number(e.points),category:e.category||"",description:e.description||"",imageUrl:r,stock:null!==e.stock?Number(e.stock):0,featured:!!e.featured,virtual:!!e.virtual,priceType:a}),O(null),F(r),z(!0)},ep=async()=>{console.log("Refreshing market items data with cache busting..."),H(!0);try{let e=Date.now(),t=await fetch("/api/market/items?t=".concat(e),{method:"GET",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},next:{revalidate:0}});if(!t.ok)throw Error("API error: ".concat(t.status));let a=await t.json();if(a.success&&a.items)console.log("Loaded ".concat(a.items.length," items from API")),A(a.items),localStorage.setItem(I,JSON.stringify(a.items));else throw console.error("API returned success: false or no items"),Error("Failed to load market items")}catch(e){console.error("Error refreshing data:",e),S.toast.error("Veri yenileme hatası. Yerel \xf6nbellek kullanılıyor.");try{let e=localStorage.getItem(I);if(e){let t=JSON.parse(e);A(t),console.log("Loaded ".concat(t.length," items from localStorage"))}}catch(e){console.error("Error loading from localStorage:",e)}}finally{H(!1)}},ef=(e,t)=>"USD"===t?"".concat(e,"$"):"TRY"===t?"".concat(e,"₺"):"".concat(e),ex=async(e,t)=>{console.log("Uploading image: ".concat(e.name,", size: ").concat(e.size,", type: ").concat(e.type)),console.log("Old image URL: ".concat(t||"none")),G(!0);let a=null;for(let r=1;r<=2;r++)try{console.log("Upload attempt ".concat(r,"/").concat(2));let a=new FormData;a.append("file",e);let s=new AbortController,l=setTimeout(()=>s.abort(),1e4);if(t){a.append("oldImageUrl",t),console.log("Using PUT method to update existing image");let e=await fetch("/api/upload/market-images",{method:"PUT",body:a,cache:"no-store",headers:{"Cache-Control":"no-cache"},signal:s.signal});if(clearTimeout(l),!e.ok){let t=await e.json().catch(()=>({error:"Upload failed: ".concat(e.status)}));throw console.error("Upload failed with status ".concat(e.status,":"),t),Error(t.error||"Upload failed: ".concat(e.status))}let r=await e.json();return console.log("Image updated successfully:",r),"".concat(r.fileUrl,"?t=").concat(Date.now())}{console.log("Using POST method to upload new image");let e=await fetch("/api/upload/market-images",{method:"POST",body:a,cache:"no-store",headers:{"Cache-Control":"no-cache"},signal:s.signal});if(clearTimeout(l),!e.ok){let t=await e.json().catch(()=>({error:"Upload failed: ".concat(e.status)}));throw console.error("Upload failed with status ".concat(e.status,":"),t),Error(t.error||"Upload failed: ".concat(e.status))}let t=await e.json();return console.log("Image uploaded successfully:",t),"".concat(t.fileUrl,"?t=").concat(Date.now())}}catch(e){if(a=e,console.error("Image upload attempt ".concat(r," failed:"),e),"AbortError"===e.name)console.error("Upload request timed out"),r<2&&(console.log("Upload timed out. Retrying in ".concat(2e3,"ms...")),await new Promise(e=>setTimeout(e,2e3)));else if(r<2){let e=Math.min(1e3*Math.pow(2,r-1),4e3);console.log("Retrying upload in ".concat(e,"ms...")),await new Promise(t=>setTimeout(t,e))}}return(console.error("All ".concat(2," upload attempts failed:"),a),t)?(console.log("Returning original image URL as fallback:",t),t):(console.log("Using default placeholder image"),"/market-img/placeholder-product.jpg")},ey=async e=>{if(e.preventDefault(),!ee.name){V("\xdcr\xfcn adı gereklidir");return}if(!ee.price){V("\xdcr\xfcn fiyatı gereklidir");return}if(!ee.points){V("\xdcr\xfcn puanı gereklidir");return}if(!ee.category){V("Kategori se\xe7melisiniz");return}try{var t,a;q(!0);let e=ee.imageUrl;if(R)try{e=await ex(R,M?ee.imageUrl:void 0),console.log("Image uploaded successfully:",e)}catch(t){console.error("Error uploading image:",t),S.toast.error("Resim y\xfcklenemedi, ama \xfcr\xfcn kaydedilecek"),e=M?ee.imageUrl:""}let r={id:M||(0,C.Z)(),name:ee.name,price:ef(ee.price,ee.priceType),points:parseInt((null===(t=ee.points)||void 0===t?void 0:t.toString())||"0"),category:ee.category,description:ee.description||"",imageUrl:e,stock:ee.virtual?-1:parseInt((null===(a=ee.stock)||void 0===a?void 0:a.toString())||"0"),featured:ee.featured,virtual:ee.virtual,priceValue:ee.price};M?A(e=>e.map(e=>e.id===r.id?r:e)):A(e=>[...e,r]);let s=M?T.map(e=>e.id===r.id?r:e):[...T,r];localStorage.setItem(I,JSON.stringify(s));let l=!1,o="";try{let e=M?{item:r}:{items:s},t=await fetch("/api/market/items",{method:M?"PATCH":"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache"},cache:"no-store",body:JSON.stringify(e)}),a=await t.json();l=a.success,o="Saved via API",console.log("API response:",a)}catch(e){console.error("API saving failed:",e);try{console.log("Trying direct Supabase save...");let e=await ei(s);l=e.success,o="Saved directly to database",console.log("Items saved directly to Supabase:",e)}catch(e){console.error("Supabase saving failed:",e),l=!0,o="Saved to local storage only (offline mode)"}}l||o.includes("local storage")?(S.toast.success(M?"\xdcr\xfcn başarıyla g\xfcncellendi!":"Yeni \xfcr\xfcn başarıyla eklendi!"),o.includes("local storage")&&(0,S.toast)("\xdcr\xfcn sadece yerel olarak saklandı. \xc7evrimi\xe7i olduğunuzda senkronize edilecek.",{icon:"⚠️",duration:5e3}),z(!1),et({name:"",price:0,points:0,category:"betting",description:"",imageUrl:"",stock:-1,featured:!1,virtual:!1,priceType:"TRY"}),O(null),F(null),setTimeout(async()=>{await ep(),ec()},500)):S.toast.error("\xdcr\xfcn kaydedilirken bir hata oluştu")}catch(e){console.error("Form submission error:",e),S.toast.error("Beklenmeyen bir hata oluştu")}finally{q(!1)}},eb=e=>{let{name:t,value:a}=e.target;er(e=>({...e,[t]:"points"===t?parseInt(a)||0:a}))};return((0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/list-market-images");if(e.ok){let t=await e.json();Array.isArray(t.images)?(el(t.images),console.log("Loaded market images:",t.images)):(console.error("Invalid images data format:",t),el(["/market-img/zlat.png","/market-img/default.png"]))}else console.error("Failed to load market images:",e.statusText),el(["/market-img/zlat.png","/market-img/default.png"])}catch(e){console.error("Error loading market images:",e),el(["/market-img/zlat.png","/market-img/default.png"])}})()},[]),a)?(0,r.jsx)(N.Z,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-blue-200 rounded-full animate-spin mb-4 mx-auto"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Y\xfckleniyor..."})]})})}):(0,r.jsxs)(N.Z,{children:[(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(n.default,{href:"/admin",className:"flex items-center text-blue-400 hover:text-blue-300 mb-2",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5 mr-1"})," Admin Paneline D\xf6n"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Market Y\xf6netimi"}),(0,r.jsx)("p",{className:"text-gray-400",children:"\xdcr\xfcnleri ekle, d\xfczenle veya sil"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:ep,className:"text-gray-400 hover:text-blue-400 p-2 rounded-md",disabled:B,title:"Verileri Yenile",children:B?(0,r.jsx)(d.Z,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)(m.Z,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",placeholder:"\xdcr\xfcn ara...",className:"bg-gray-700 text-white px-4 py-2 pl-10 rounded-md w-64 focus:outline-none focus:ring-2 focus:ring-blue-500",value:Z,onChange:e=>P(e.target.value)}),(0,r.jsx)(u.Z,{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5"})]}),(0,r.jsxs)("button",{onClick:eg,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center",disabled:_,children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 mr-1.5"})," Yeni \xdcr\xfcn"]})]})]}),J&&(0,r.jsxs)("div",{className:"bg-red-900/50 border border-red-800 text-red-100 px-4 py-3 rounded-md mb-6 flex items-start",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5 text-red-400 mr-2 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Hata oluştu"}),(0,r.jsx)("p",{className:"text-sm",children:J})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 mb-8",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-white mb-4 flex items-center",children:[(0,r.jsx)(f,{className:"mr-2 text-blue-400"})," Bahis Siteleri Ekle"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-gray-400 text-sm",children:"Site Adı"}),(0,r.jsx)("input",{type:"text",placeholder:"\xf6r. Zlot1000",className:"w-full bg-gray-700 text-white px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"name",value:ea.name,onChange:eb})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-gray-400 text-sm",children:"JackPoint Değeri"}),(0,r.jsx)("input",{type:"number",placeholder:"\xf6r. 3500",className:"w-full bg-gray-700 text-white px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"points",value:ea.points,onChange:eb})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-gray-400 text-sm",children:"Logo Se\xe7"}),(0,r.jsxs)("select",{className:"w-full bg-gray-700 text-white px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"imageUrl",value:ea.imageUrl,onChange:eb,children:[(0,r.jsx)("option",{value:"",children:"Logo Se\xe7"}),es.map((e,t)=>(0,r.jsx)("option",{value:e,children:e.split("/").pop()},t))]})]}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsx)("button",{onClick:()=>{if(!ea.name.trim()){S.toast.error("Site adı gereklidir");return}if(!ea.points){S.toast.error("JackPoint değeri gereklidir");return}if(!ea.imageUrl){S.toast.error("Logo se\xe7imi gereklidir");return}let e=[...T,{id:(0,C.Z)(),name:ea.name.trim(),price:"30$",points:ea.points,category:"betting",description:"Market \xdczerinden Satın alma işlemi ger\xe7ekleştirdikten sonra Telegram Grubu \xfczerinden bizlere "+ea.name+" kullanıcı adınızı iletmeniz Gerekmektedir.",imageUrl:ea.imageUrl,stock:-1,featured:!0,virtual:!0,priceValue:30}];A(e),localStorage.setItem(I,JSON.stringify(e)),ei(e).then(e=>{e.success?console.log("Partner site saved to Supabase:",e):console.warn("Partner site saved to localStorage only:",e.message)}).catch(e=>{console.error("Error saving partner site:",e)}),er({name:"",points:3500,imageUrl:"/market-img/zlat.png"}),S.toast.success("Bahis sitesi başarıyla eklendi"),ec(),setTimeout(()=>{ep().catch(e=>console.error("Refresh error:",e))},500)},className:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Bahis Sitesi Ekle"})})]}),(0,r.jsx)("div",{className:"text-gray-400 text-sm",children:'Not: Bahis siteleri otomatik olarak "Bahis Sitesi" kategorisinde eklenecektir.'})]}),(0,r.jsxs)("div",{className:"flex mb-6 space-x-2 overflow-x-auto pb-2",children:[(0,r.jsx)("button",{onClick:()=>P(""),className:"px-4 py-2 rounded-full whitespace-nowrap ".concat(""===Z?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"T\xfcm \xdcr\xfcnler"}),(0,r.jsx)("button",{onClick:()=>P("betting"),className:"px-4 py-2 rounded-full whitespace-nowrap ".concat("betting"===Z?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"Bahis Siteleri"})]}),0===eu.length?(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[(0,r.jsx)(x.Z,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-xl font-medium text-white mb-2",children:"\xdcr\xfcn bulunamadı"}),(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:"Arama kriterlerinize uygun \xfcr\xfcn bulunamadı."}),(0,r.jsxs)("button",{onClick:eg,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md inline-flex items-center",children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 mr-1.5"})," Yeni \xdcr\xfcn Ekle"]})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:eu.map(e=>(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg overflow-hidden shadow-lg",children:[(0,r.jsxs)("div",{className:"relative h-48",children:[e.imageUrl?(0,r.jsx)("div",{className:"w-full h-full bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(".concat(e.imageUrl.includes("?")?e.imageUrl:"".concat(e.imageUrl,"?t=").concat(Date.now()),")")}}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-700",children:(0,r.jsx)(y,{className:"w-16 h-16 text-gray-600"})}),e.featured&&(0,r.jsx)("span",{className:"absolute top-2 right-2 bg-yellow-500 text-black text-xs font-medium px-2 py-1 rounded-full",children:"\xd6ne \xc7ıkan"})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-white",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>eh(e),className:"text-blue-400 hover:text-blue-300",title:"D\xfczenle",disabled:K===e.id,children:(0,r.jsx)(b.Z,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>ed(e.id),className:"text-red-400 hover:text-red-300",title:"Sil",disabled:K===e.id,children:K===e.id?(0,r.jsx)(d.Z,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)(k.Z,{className:"w-5 h-5"})})]})]}),(0,r.jsx)("div",{className:"text-gray-400 text-sm mb-2 line-clamp-2",title:e.description,children:e.description||"A\xe7ıklama yok"}),(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(v.Z,{className:"w-5 h-5 text-yellow-500 mr-1.5"}),(0,r.jsxs)("span",{className:"text-white font-medium",children:[e.points||0," Jackpoint"]})]})})]})]},e.id))})]}),D&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg shadow-lg max-w-3xl w-full max-h-[90vh] overflow-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:M?"\xdcr\xfcn D\xfczenle":"Yeni \xdcr\xfcn Ekle"}),(0,r.jsx)("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-white",disabled:_,children:(0,r.jsx)(w.Z,{className:"w-6 h-6"})})]}),(0,r.jsxs)("form",{onSubmit:ey,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-gray-400",children:["\xdcr\xfcn Adı ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"name",value:ee.name,onChange:e=>et({...ee,name:e.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(Q.name?"border border-red-500":""),placeholder:"\xdcr\xfcn adı",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-gray-400",children:["JackPoint Değeri ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"number",name:"points",value:ee.points,onChange:e=>et({...ee,points:parseInt(e.target.value)||0}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(Q.points?"border border-red-500":""),placeholder:"JackPoint değeri",min:"0",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-gray-400",children:["Fiyat ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"number",name:"price",value:ee.price,onChange:e=>et({...ee,price:parseFloat(e.target.value)||0}),className:"flex-1 bg-gray-700 text-white px-4 py-2 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(Q.price?"border border-red-500":""),placeholder:"Fiyat değeri",min:"0",step:"0.01",required:!0}),(0,r.jsxs)("select",{name:"priceType",value:ee.priceType,onChange:e=>et({...ee,priceType:e.target.value}),className:"bg-gray-700 text-white px-3 py-2 rounded-r-md border-l border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"TRY",children:"₺"}),(0,r.jsx)("option",{value:"USD",children:"$"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-gray-400",children:"Stok Durumu"}),(0,r.jsx)("input",{type:"number",name:"stock",value:ee.stock,onChange:e=>et({...ee,stock:parseInt(e.target.value)||0}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Stok adedi",min:"0",disabled:ee.virtual})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"A\xe7ıklama"}),(0,r.jsx)("textarea",{name:"description",value:ee.description,onChange:e=>et({...ee,description:e.target.value}),className:"w-full h-24 px-3 py-2 bg-gray-700 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"\xdcr\xfcn a\xe7ıklaması"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"virtual",name:"virtual",checked:ee.virtual,onChange:e=>et({...ee,virtual:e.target.checked}),className:"h-4 w-4 bg-gray-700 border-gray-600 rounded text-blue-500 focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"virtual",className:"ml-2 text-sm text-gray-300",children:"Stok Takibi Yapma"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"featured",name:"featured",checked:ee.featured,onChange:e=>et({...ee,featured:e.target.checked}),className:"h-4 w-4 bg-gray-700 border-gray-600 rounded text-blue-500 focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"featured",className:"ml-2 text-sm text-gray-300",children:"\xd6ne \xc7ıkan \xdcr\xfcn"})]}),(0,r.jsx)("input",{type:"hidden",name:"category",value:"betting"})]}),J&&(0,r.jsxs)("div",{className:"bg-red-900/50 border border-red-800 text-red-100 px-4 py-3 rounded-md mb-6 flex items-start",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5 text-red-400 mr-2 mt-0.5"}),(0,r.jsx)("p",{children:J})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>z(!1),className:"px-6 py-2 rounded-md border border-gray-600 text-gray-300 hover:bg-gray-700",disabled:_,children:"İptal"}),(0,r.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 flex items-center",disabled:_,children:_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"w-5 h-5 mr-2 animate-spin"}),"İşleniyor..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Z,{className:"w-5 h-5 mr-2"}),M?"G\xfcncelle":"Kaydet"]})})]})]})]})})})]})}},9644:function(e,t,a){"use strict";let r;a.d(t,{Z:function(){return n}});var s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let l=new Uint8Array(16),o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));var n=function(e,t,a){var n,i,c;if(s.randomUUID&&!t&&!e)return s.randomUUID();let d=null!==(c=null!==(i=(e=e||{}).random)&&void 0!==i?i:null===(n=e.rng)||void 0===n?void 0:n.call(e))&&void 0!==c?c:function(){if(!r){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(l)}();if(d.length<16)throw Error("Random bytes length must be >= 16");if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,t){if((a=a||0)<0||a+16>t.length)throw RangeError("UUID byte range ".concat(a,":").concat(a+15," is out of buffer bounds"));for(let e=0;e<16;++e)t[a+e]=d[e];return t}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}(d)}}},function(e){e.O(0,[8240,703,8792,3755,8009,5947,5494,2971,8069,1744],function(){return e(e.s=8711)}),_N_E=e.O()}]);