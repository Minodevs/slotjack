(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4454],{2610:function(e,t,s){Promise.resolve().then(s.bind(s,5118))},4314:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},8904:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},7759:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]])},527:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},4715:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},1708:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},7841:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5904:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},5118:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var a=s(3827),r=s(4090),l=s(5947),n=s(7907),i=s(8792),c=s(5561),o=s(9108),d=s(834),m=s(4715),u=s(1708),x=s(8670),h=s(7307),p=s(1213),g=s(5904),f=s(527),y=s(7759),b=s(9990);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let j=(0,s(7461).Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var N=s(7841),v=s(8904),w=s(4314),k=s(5494),Z=s(8435),E=s(2171);let S=async()=>{console.log("Migration stub called - this is a placeholder implementation");try{let e=localStorage.getItem("transactions");if(!e)return console.log("No local transactions found to migrate"),{success:!0,migrated:0,errors:0,message:"No local transactions found to migrate"};let t=JSON.parse(e);return console.log("Found ".concat(t.length," local transactions")),{success:!0,migrated:0,errors:0,message:"Migration simulation complete"}}catch(e){return console.error("Error during transaction migration:",e),{success:!1,migrated:0,errors:1,message:"Migration failed: ".concat(e instanceof Error?e.message:"Unknown error")}}};window.migrateTransactionsToSupabase=S,console.log("Migration script loaded. Run window.migrateTransactionsToSupabase() to start migration.");var M=s(8009);function C(){let e=(0,n.useRouter)(),t=(0,l.useAuth)(),[s,C]=(0,r.useState)(!0),[I,A]=(0,r.useState)(!1),[T,D]=(0,r.useState)([]),[L,_]=(0,r.useState)([]),[P,U]=(0,r.useState)(""),[F,O]=(0,r.useState)("all"),[q,z]=(0,r.useState)("all"),[K,B]=(0,r.useState)(!1);if(!t)throw Error("AuthContext is undefined");let{user:H}=t;(0,r.useEffect)(()=>{if(!s&&(!H||H.rank!==c.X.ADMIN)){e.push("/");return}H&&H.rank===c.X.ADMIN&&R()},[H,s,e]);let R=async()=>{A(!0);try{console.log("Loading transactions from database...");let e=await E._v();0===e.length?(console.log("No transactions found in the database"),M.default.success("No transactions found in the database")):(console.log("Loaded ".concat(e.length," transactions successfully")),M.default.success("Loaded ".concat(e.length," transactions"))),D(e),_(e)}catch(e){console.error("Error loading transactions:",e),M.default.error("Failed to load transactions: ".concat(e instanceof Error?e.message:"Unknown error"));try{let e=JSON.parse(localStorage.getItem("slotjack_transactions_cache")||"[]");e.length>0&&(D(e),_(e),M.default.success("Loaded ".concat(e.length," transactions from cache")))}catch(e){console.error("Error loading from cache:",e)}}finally{C(!1),A(!1)}};(0,r.useEffect)(()=>{let e=setInterval(()=>{I||R()},3e4);return()=>{clearInterval(e)}},[I]),(0,r.useEffect)(()=>{let e=[...T];if(P){let t=P.toLowerCase();e=e.filter(e=>e.description.toLowerCase().includes(t)||e.userEmail.toLowerCase().includes(t)||e.userName&&e.userName.toLowerCase().includes(t))}if("all"!==F&&(e=e.filter(e=>e.type===F)),"all"!==q){let t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),a=s-6048e5,r=new Date(t.getFullYear(),t.getMonth()-1,t.getDate()).getTime();switch(q){case"today":e=e.filter(e=>e.timestamp>=s);break;case"week":e=e.filter(e=>e.timestamp>=a);break;case"month":e=e.filter(e=>e.timestamp>=r)}}_(e)},[P,F,q,T]);let G=e=>{try{return(0,Z.WU)(new Date(e),"dd/MM/yyyy HH:mm")}catch(e){return"Invalid date"}},J=e=>e?e.startsWith("+")?e:"+".concat(e):"",V=(e,t)=>{if(!t)return"";switch(e.toLowerCase()){case"telegram":return"https://t.me/".concat(t.replace("@",""));case"discord":return"https://discord.com/users/".concat(t);case"instagram":return"https://instagram.com/".concat(t.replace("@",""));default:return""}},Y=async()=>{if(confirm("This will migrate all transactions from localStorage to the Supabase database. Continue?"))try{B(!0);let e=await S();B(!1),e&&e.success&&e.migrated>0?(M.default.success("Successfully migrated ".concat(e.migrated," transactions. Failed: ").concat(e.errors)),R()):M.default.error("No transactions were migrated. Check console for details.")}catch(e){console.error("Migration error:",e),B(!1),M.default.error("Failed to migrate transactions. See console for details.")}};return s?(0,a.jsx)(k.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-blue-200 rounded-full animate-spin mb-4 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Y\xfckleniyor..."})]})})}):(0,a.jsx)(k.Z,{children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.default,{href:"/admin",className:"flex items-center text-blue-400 hover:text-blue-300 mb-2",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 mr-1"})," Admin Paneline D\xf6n"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-white",children:"İşlem Ge\xe7mişi"}),(0,a.jsx)("p",{className:"text-gray-400",children:"T\xfcm kullanıcıların işlemlerini g\xf6r\xfcnt\xfcle ve y\xf6net"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("button",{onClick:()=>{R()},className:"px-3 py-2 bg-blue-600 text-white rounded-md flex items-center disabled:opacity-50",disabled:K,children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,a.jsxs)("button",{onClick:()=>{let e=["Date,User,Email,Phone,Telegram,Discord,Type,Amount,Description",...L.map(e=>{var t,s;return[G(e.timestamp),e.userName||e.userEmail.split("@")[0],e.userEmail,J(e.userPhone||""),(null===(t=e.userSocialMedia)||void 0===t?void 0:t.telegram)||"",(null===(s=e.userSocialMedia)||void 0===s?void 0:s.discord)||"","earn"===e.type?"Earn":"spend"===e.type?"Spend":"bonus"===e.type?"Bonus":"event"===e.type?"Event":"Admin",e.amount,e.description]}).map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(","))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(t),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download","transactions-".concat(new Date().toISOString().slice(0,10),".csv")),document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"px-3 py-2 bg-blue-600 text-white rounded-md flex items-center disabled:opacity-50",disabled:K,children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),(0,a.jsxs)("button",{onClick:Y,className:"px-3 py-2 bg-purple-600 text-white rounded-md flex items-center disabled:opacity-50",disabled:K,children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Migrate from Local"]})]})]}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(x.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{type:"text",className:"bg-gray-700 text-white w-full pl-10 pr-4 py-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ara (a\xe7ıklama, kullanıcı)",value:P,onChange:e=>U(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:"İşlem Tipi"}),(0,a.jsxs)("select",{className:"bg-gray-700 text-white w-full px-3 py-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:F,onChange:e=>O(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"T\xfcm\xfc"}),(0,a.jsx)("option",{value:"earn",children:"Kazanılan"}),(0,a.jsx)("option",{value:"spend",children:"Harcanan"}),(0,a.jsx)("option",{value:"bonus",children:"Bonus"}),(0,a.jsx)("option",{value:"event",children:"Etkinlik"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:"Tarih Aralığı"}),(0,a.jsxs)("select",{className:"bg-gray-700 text-white w-full px-3 py-2 rounded-md border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:q,onChange:e=>z(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"T\xfcm Zamanlar"}),(0,a.jsx)("option",{value:"today",children:"Bug\xfcn"}),(0,a.jsx)("option",{value:"week",children:"Son 7 G\xfcn"}),(0,a.jsx)("option",{value:"month",children:"Son 30 G\xfcn"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsxs)("div",{className:"bg-gray-700 px-4 py-2 rounded-md w-full text-center",children:[(0,a.jsx)("span",{className:"text-gray-400 block text-sm",children:"Toplam İşlem"}),(0,a.jsx)("span",{className:"text-xl font-bold",children:L.length})]})})]})}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-1"}),"Tarih"]})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-1"}),"Kullanıcı"]})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-1"}),"İletişim"]})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-1"}),"İşlem Tipi"]})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 mr-1"}),"Miktar"]})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"A\xe7ıklama"})]})}),(0,a.jsx)("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:0===L.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(f.Z,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"İşlem bulunamadı"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Farklı filtreler deneyerek i\xe7eriği g\xf6rebilirsiniz"})]})})}):L.map(t=>{var s,r;return(0,a.jsxs)("tr",{className:"hover:bg-gray-750",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:G(t.timestamp)}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-white",children:t.userName||t.userEmail.split("@")[0]}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:t.userEmail})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[t.userPhone?(0,a.jsxs)("a",{href:"tel:".concat(J(t.userPhone)),className:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-blue-900 text-blue-300 hover:bg-blue-800",children:[(0,a.jsx)(g.Z,{className:"w-3 h-3 mr-1"})," ",J(t.userPhone)]}):(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-gray-700 text-gray-400",children:[(0,a.jsx)(g.Z,{className:"w-3 h-3 mr-1"})," Telefon yok"]}),(null===(s=t.userSocialMedia)||void 0===s?void 0:s.telegram)&&(0,a.jsxs)("a",{href:V("telegram",t.userSocialMedia.telegram),target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-sky-900 text-sky-300 hover:bg-sky-800",children:[(0,a.jsx)(b.Z,{className:"w-3 h-3 mr-1"})," ",t.userSocialMedia.telegram]}),(null===(r=t.userSocialMedia)||void 0===r?void 0:r.discord)&&(0,a.jsxs)("a",{href:V("discord",t.userSocialMedia.discord),target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-indigo-900 text-indigo-300 hover:bg-indigo-800",children:[(0,a.jsx)(j,{className:"w-3 h-3 mr-1"})," ",t.userSocialMedia.discord]}),(t.userId||t.userEmail)&&(0,a.jsxs)("button",{onClick:()=>{try{let s=localStorage.getItem("slotjack_registered_users");if(s){let a=JSON.parse(s),r=null;Object.entries(a).forEach(e=>{let[s,a]=e;(t.userId&&a.id===t.userId||t.userEmail&&s===t.userEmail)&&(r=a.id,console.log("Found user ID:",r,"for email:",t.userEmail))}),r?e.push("/admin/users/".concat(r)):t.userId?(e.push("/admin/users/".concat(t.userId)),console.log("User not found in registered users, using transaction userId directly:",t.userId)):(M.default.error("Kullanıcı bulunamadı: ".concat(t.userEmail||"E-posta bilgisi eksik")),console.error("User not found in registered users:",t.userEmail))}else t.userId?e.push("/admin/users/".concat(t.userId)):M.default.error("Kullanıcı verileri y\xfcklenemedi: Kullanıcı kayıtları bulunamadı")}catch(s){console.error("Error getting user data:",s),t.userId?e.push("/admin/users/".concat(t.userId)):M.default.error("Kullanıcı bilgilerine erişilemiyor: ".concat(s instanceof Error?s.message:"Bilinmeyen hata"))}},className:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-gray-700 text-gray-300 hover:bg-gray-600 mt-1",children:[(0,a.jsx)(N.Z,{className:"w-3 h-3 mr-1"})," Profili G\xf6r"]})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:["earn"===t.type&&(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-900 text-green-300",children:[(0,a.jsx)(v.Z,{className:"w-3 h-3 mr-1"})," Kazan\xe7"]}),"spend"===t.type&&(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-900 text-red-300",children:[(0,a.jsx)(w.Z,{className:"w-3 h-3 mr-1"})," Harcama"]}),"bonus"===t.type&&(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-900 text-blue-300",children:[(0,a.jsx)(v.Z,{className:"w-3 h-3 mr-1"})," Bonus"]}),"event"===t.type&&(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-900 text-purple-300",children:[(0,a.jsx)(v.Z,{className:"w-3 h-3 mr-1"})," Etkinlik"]}),"admin"===t.type&&(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-900 text-yellow-300",children:[(0,a.jsx)(v.Z,{className:"w-3 h-3 mr-1"})," Admin"]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,a.jsxs)("span",{className:"font-medium ".concat("spend"===t.type?"text-red-400":"text-green-400"),children:["spend"===t.type?"-":"+",Math.abs(t.amount)]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-300",children:t.description})]},t.id)})})]})})})]})})}}},function(e){e.O(0,[8240,703,8792,3755,8009,7477,5947,5494,2971,8069,1744],function(){return e(e.s=2610)}),_N_E=e.O()}]);